<!DOCTYPE html>
<html lang="zh-CN"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="傅杭波, Uhfun傅杭波, Uhfun, UhfunBlog, Hbson傅杭波, Hb, Hbson, 博客, 个人网站, 互联网, 后端, Web, Java, Spring, 翻唱, 唱歌">
  <meta name="description" content='代码与生活、热爱唱歌的boy | 傅杭波的个人博客'>
  <meta name="robots" content="all">
  <meta property="og:type" content="post" /><meta property="og:title" content="MyBatis 入门 | UhfunBlog" />
  <meta property="og:image" content='https://uhfun.cn/assetshttps://s1.ax1x.com/2020/06/04/t0QjeK.jpg' />
  <meta property="og:type" content="article">
  <meta property="og:description" content="Ｍｙｂａｔｉｓ入门啦。

"><meta property="article:published_time" content='2018-05-23T20:32:00Z'><meta property="article:author" content="傅杭波"><meta property="og:image" content="https://s1.ax1x.com/2020/06/04/tw8zs1.jpg" >
  <meta property="og:url" content="https://uhfun.cn/tech/2018/05/23/Mybatis%E5%85%A5%E9%97%A8.html"><meta property="article:tag" content="Mybatis"><meta property="article:tag" content="入门"><meta property="og:site_name" content="傅杭波的博客UhfunBlog" />
  <meta name="baidu-site-verification" content= "9DYfdd4yEo" />
  <meta name="google-site-verification" content="uDSkqT9lEtkk2RsKYeldTKkmr4u_yI5aR3Y-tGgjcBo" />
  <title>MyBatis 入门 | UhfunBlog</title>
  <!-- Favicon -->
  <link rel="shortcut icon" href="/assets/img/favicon.ico">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="https://uhfun.cn/feed.xml" title="UhfunBlog" /><!-- <script data-ad-client="ca-pub-1900429580469964" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/font-awesome/5.11.2/js/all.min.js"></script>
</head><body><header class="navbar has-shadow is-spaced" role="banner">
  <div class="container"><div class="navbar-brand">
      <a class="navbar-item" href="/">
        <img src='https://s1.ax1x.com/2020/06/04/t0QDIg.png' width="160">
      </a>
      <div role="button" class="navbar-burger burger" data-target="navbarExampleTransparentExample">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </div>
    </div>
    <div class="navbar-menu">      
      <div class="navbar-end">
        <a class='navbar-item' href='/'>主页</a><a class="navbar-item" href="/README.html">自述
        </a><a class="navbar-item" href="/search/">搜索
        </a><a class="navbar-item" href="/tag/">标签
        </a><a class="navbar-item" href="/life/">生活
        </a><a class="navbar-item" href="/tech/">技术
        </a><div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
              <img class="is-rounded" src='https://s1.ax1x.com/2020/06/04/t0QjeK.jpg'>
          </a>
          <div class="navbar-dropdown is-right">
            <a class="icon-dropdown navbar-item" href="/about.html">
              <i class="far fa-user" aria-hidden="true"></i> 关于
            </a>
            <a class="icon-dropdown navbar-item" href="https://github.com/uhfun">
              <i class="fab fa-github" aria-hidden="true"></i> Github
            </a>
            <hr class="navbar-divider">
            <a class="navbar-item" href="/README.html#utterances"> 报告问题
            </a>
          </div>
        </div>
      </div>
    </div></div>
</header>
<div class="section">
    <div class="container">
      <article class="page">
  <div class="content">
    <article class="post"><h1 class="title is-spaced">MyBatis 入门</h1><div class="tags">
    <div class="container"><span class="icon is-small">
            <i class="fa fa-tags" aria-hidden="true"></i>
        </span><a href="/tag/mybatis">Mybatis</a><a href="/tag/%e5%85%a5%e9%97%a8">入门</a>
        <span class="spot">•</span>
        <span class='formated-date' data-time="2018/05/23 20:32:00">
            2018-05-23
        </span><span class="spot">•</span>
        <span>26分钟
        </span></div>
</div><div class='post-img'><img src='https://s1.ax1x.com/2020/06/04/tw8zs1.jpg'></div><div class='post-content'>
    <div id="toc"></div><p>Ｍｙｂａｔｉｓ入门啦。</p>

<h2 id="了解mybatis">了解Mybatis</h2>
<h3 id="什么是mybatis">什么是Mybatis</h3>
<p>　　MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，实质上Mybatis对ibatis进行一些改进。<br />
　　MyBatis 是一款优秀的持久层框架，它支持定制化 SQL、存储过程以及高级映射。MyBatis 避免了几乎所有的 JDBC 代码（例如注册驱动、创建connection、创建statement）和手动设置参数以及获取结果集。<br />
　　MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p>
<h2 id="mybatis执行过程">Mybatis执行过程</h2>
<ol>
  <li>从 XML 中构建 SqlSessionFactory <br />
<strong><em>SqlMapConfig.xml</em></strong>   ，Mybatis的全局配置文件，包含了对 MyBatis 系统的核心设置，包含获取数据库连接实例的数据源（DataSource）和决定事务作用域和控制方式的事务管理器（TransactionManager）</li>
  <li>从 SqlSessionFactory 中获取 SqlSession  
SqlSession，面向用户的接口，完全包含了面向数据库执行 SQL 命令所需的所有方法。</li>
  <li>SqlSession 调用 Excutor（数据库操作执行器）操作数据库<br />
接口，负责sql语句动态生成和缓存的维护</li>
  <li>数据封装在MappedStatement  
MappedStatement类在Mybatis框架中用于表示XML文件中一个sql语句节点，即一个&lt;select /&gt;、&lt;update/&gt;或者&lt;insert/&gt;标签。Mybatis框架在初始化阶段会对XML配置文件进行读取，将其中的sql语句节点对象化为一个个MappedStatement对象。</li>
  <li>完成输入输出映射<br />
Mybatis中输入映射和输出映射可以是基本数据类型、hashmap、pojo、pojo的包装类型</li>
</ol>

<h2 id="mybatis入门开发">Mybatis入门开发</h2>
<h3 id="原始方式">原始方式</h3>
<h4 id="1创建usermapper">1、创建UserMapper</h4>
<p><strong>UserMapper.xml</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" &gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"test"</span><span class="nt">&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findUserById"</span> <span class="na">parameterType=</span><span class="s">"int"</span> <span class="na">resultType=</span><span class="s">"user"</span><span class="nt">&gt;</span>
	SELECT * FROM USER WHERE id= #{id}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div></div>
<h4 id="2创建pojo">2、创建Pojo</h4>
<p><strong>User.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">uhfun</span><span class="o">.</span><span class="na">webssm</span><span class="o">.</span><span class="na">po</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPassword</span><span class="o">(</span><span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">"User{"</span> <span class="o">+</span>
				<span class="s">"id="</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span>
				<span class="s">", username='"</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="sc">'\''</span> <span class="o">+</span>
				<span class="sc">'}'</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="3引入mapper文件">3、引入mapper文件</h4>
<p><strong>SqlMapConfig.xml</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE configuration
PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
	<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">"db.properties"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;typeAliases&gt;</span>
		<span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"cn.itcast.mybatis.po"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/typeAliases&gt;</span>
	<span class="c">&lt;!-- 和spring整合后 environments配置将废除--&gt;</span>
	<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">"development"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"development"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span> <span class="nt">/&gt;</span>
			<span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"${jdbc.driver}"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${jdbc.url}"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${jdbc.username}"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${jdbc.password}"</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;/dataSource&gt;</span>
		<span class="nt">&lt;/environment&gt;</span>
	<span class="nt">&lt;/environments&gt;</span>
	<span class="nt">&lt;mappers&gt;</span>
		<span class="c">&lt;!-- 通过resource引用mapper的映射文件 --&gt;</span>
		<span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"sqlmap/User.xml"</span> <span class="nt">/&gt;</span>		
		<span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"cn.itcast.mybatis.mapper"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>
<h4 id="4创建dao接口">4、创建Dao接口</h4>
<p><strong>UserDao.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">uhfun</span><span class="o">.</span><span class="na">mybatis</span><span class="o">.</span><span class="na">dao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.po.User</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserDao</span> <span class="o">{</span>
	<span class="c1">//根据id查询用户信息</span>
	<span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="5实现dao接口">5、实现Dao接口</h4>
<p><strong>UserDaoImpl.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">uhfun</span><span class="o">.</span><span class="na">mybatis</span><span class="o">.</span><span class="na">dao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.po.User</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoImpl</span> <span class="kd">implements</span> <span class="nc">UserDao</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
	<span class="c1">// 将SqlSessionFactory注入</span>
	<span class="kd">public</span> <span class="nf">UserDaoImpl</span><span class="o">(</span><span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">sqlSessionFactory</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="c1">// 创建SqlSession</span>
		<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="c1">// 根据id查询用户信息</span>
		<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectOne</span><span class="o">(</span><span class="s">"test.findUserById"</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
		<span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="k">return</span> <span class="n">user</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="6编写测试类">6、编写测试类</h4>
<p><strong>MyBatisTest.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">uhfun</span><span class="o">.</span><span class="na">mybatis</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.dao.UserDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.dao.UserDaoImpl</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.po.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MybatisTest</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">"SqlMapConfig.xml"</span><span class="o">;</span>
        <span class="nc">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
        <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">UserDao</span> <span class="n">userDao</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UserDaoImpl</span><span class="o">(</span><span class="n">sqlSessionFactory</span><span class="o">);</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userDao</span><span class="o">.</span><span class="na">findUserById</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="7测试结果">7、测试结果</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">User</span><span class="o">{</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">username</span><span class="o">=</span><span class="err">'</span><span class="mi">123</span><span class="err">'</span><span class="o">}</span>
</code></pre></div></div>
<h4 id="原始方式存在的问题">原始方式存在的问题</h4>
<ol>
  <li>
    <p>dao的实现类中存在重复代码，整个mybatis操作的过程代码模板重复（先创建sqlsession、调用sqlsession的方法、关闭sqlsession）</p>
  </li>
  <li>
    <p>dao的实现 类中存在硬编码，调用sqlsession方法时将statement的id硬编码。</p>
  </li>
</ol>

<h3 id="mapper代理方式">Mapper代理方式</h3>
<h4 id="mapper开发规范">Mapper开发规范</h4>
<ol>
  <li>mapper.xml中namespace指定为mapper接口的全限定名<br />
此步骤目的：通过mapper.xml和mapper.java进行关联。</li>
</ol>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>
<span class="c">&lt;!-- namespace命名空间，为了对sql语句进行隔离，方便管理 ，mapper开发dao方式，使用namespace有特殊作用
mapper代理开发时将namespace指定为mapper接口的全限定名
 --&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"cn.uhfun.mybatis.mapper.UserMapper"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- 在mapper.xml文件中配置很多的sql语句，执行每个sql语句时，封装为MappedStatement对象
mapper.xml以statement为单位管理sql语句 --&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div></div>
<ol>
  <li>mapper.xml中statement的id就是mapper.java中方法名</li>
</ol>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"cn.uhfun.mybatis.mapper.UserMapper"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findUserById"</span> <span class="na">parameterType=</span><span class="s">"int"</span> <span class="na">resultType=</span><span class="s">"user"</span><span class="nt">&gt;</span>
          SELECT * FROM USER WHERE id= #{id}
  <span class="nt">&lt;/select&gt;</span>
  <span class="nt">&lt;/mapper&gt;</span>
</code></pre></div></div>
<p>UserMapper.java</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div></div>
<ol>
  <li>mapper.xml中statement的parameterType和mapper.java中方法输入参数类型一致</li>
  <li>mapper.xml中statement的resultType和mapper.java中方法返回值类型一致.</li>
</ol>

<h4 id="1创建usermapper-1">1、创建UserMapper</h4>
<p><strong>UserMapper.xml</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" &gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"cn.uhfun.mybatis.mapper.UserMapper"</span><span class="nt">&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findUserById"</span> <span class="na">parameterType=</span><span class="s">"int"</span> <span class="na">resultType=</span><span class="s">"user"</span><span class="nt">&gt;</span>
		SELECT * FROM USER WHERE id= #{id}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div></div>
<h4 id="2创建pojo-1">2、创建Pojo</h4>
<p><strong>User.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">uhfun</span><span class="o">.</span><span class="na">webssm</span><span class="o">.</span><span class="na">po</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPassword</span><span class="o">(</span><span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">"User{"</span> <span class="o">+</span>
				<span class="s">"id="</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span>
				<span class="s">", username='"</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="sc">'\''</span> <span class="o">+</span>
				<span class="sc">'}'</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="3引入mapper文件-1">3、引入mapper文件</h4>
<p><strong>SqlMapConfig.xml</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE configuration
PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
	<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">"db.properties"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;typeAliases&gt;</span>
		<span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"cn.itcast.mybatis.po"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/typeAliases&gt;</span>
	<span class="c">&lt;!-- 和spring整合后 environments配置将废除--&gt;</span>
	<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">"development"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"development"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span> <span class="nt">/&gt;</span>
			<span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"${jdbc.driver}"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${jdbc.url}"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${jdbc.username}"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${jdbc.password}"</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;/dataSource&gt;</span>
		<span class="nt">&lt;/environment&gt;</span>
	<span class="nt">&lt;/environments&gt;</span>
	<span class="nt">&lt;mappers&gt;</span>	
      <span class="c">&lt;!-- 批量mapper配置 
		通过package进行自动扫描包下边的mapper接口，要求：需要mapper.xml和mapper.java同名并且在一个目录中--&gt;</span>
		<span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"cn.itcast.mybatis.mapper"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>
<h4 id="4创建mapperdao接口">4、创建Mapper(Dao)接口</h4>
<p><strong>UserMapper.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">uhfun</span><span class="o">.</span><span class="na">mybatis</span><span class="o">.</span><span class="na">UserMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.po.User</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
	<span class="c1">//根据id查询用户信息</span>
	<span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="5编写测试类">5、编写测试类</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">uhfun</span><span class="o">.</span><span class="na">mybatis</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.mapper.UserMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">cn.uhfun.mybatis.po.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MybatisTest</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">"SqlMapConfig.xml"</span><span class="o">;</span>
        <span class="nc">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
        <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
        <span class="nc">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">findUserById</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>
<h4 id="6测试结果">6、测试结果</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">User</span><span class="o">{</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">username</span><span class="o">=</span><span class="err">'</span><span class="mi">123</span><span class="err">'</span><span class="o">}</span>
</code></pre></div></div>
<h3 id="原始方式与mapper代理的区别">原始方式与mapper代理的区别</h3>
<ol>
  <li>原始dao开发方法，需要程序员编写dao接口和实现类，此方法在当前企业中还有使用，因为ibatis使用的就是原始dao开发方法。</li>
  <li>mapper代理方法，程序员只需要写mapper接口（相当于dao接口），mybatis自动根据mapper接口和mapper接口对应的statement自动生成代理对象（接口实现类对象）。</li>
</ol>

<h2 id="mapperxml加载方式">Mapper.xml加载方式</h2>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;mappers&gt;</span>
		<span class="c">&lt;!-- 通过resource引用mapper的映射文件 --&gt;</span>
		<span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"sqlmap/User.xml"</span> <span class="nt">/&gt;</span>
		<span class="c">&lt;!-- &lt;mapper resource="mapper/UserMapper.xml" /&gt; --&gt;</span>
		<span class="c">&lt;!-- 通过class引用mapper接口 class：配置mapper接口全限定名
		要求：需要mapper.xml和mapper.java同名并且在一个目录 中
		--&gt;</span>
		<span class="c">&lt;!-- &lt;mapper class="UserMapper"/&gt; --&gt;</span>
		<span class="c">&lt;!-- 批量mapper配置 通过package进行自动扫描包下边的mapper接口，
		要求：需要mapper.xml和mapper.java同名并且在一个目录 中
		--&gt;</span>
		<span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"cn.itcast.mybatis.mapper"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/mappers&gt;</span>
</code></pre></div></div>

<h2 id="xml配置">XML配置</h2>
<h3 id="properties属性">properties属性</h3>
<p>可以把一些通用的属性值配置在属性文件中，加载到mybatis运行环境内。<br />
比如：创建db.properties配置数据库连接参数。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">"org/mybatis/example/config.properties"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"dev_user"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"F2Fa3!33TYyg"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/properties&gt;</span>
<span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"${driver}"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${url}"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${username}"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${password}"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/dataSource&gt;</span>
</code></pre></div></div>
<p>注意： MyBatis 将按照下面的顺序来加载属性：</p>
<ul>
  <li>在 properties 元素体内定义的属性首先被读取。</li>
  <li>然后会读取properties 元素中resource或 url 加载的属性，它会覆盖已读取的同名属性。</li>
  <li>最后读取parameterType传递的属性，它会覆盖已读取的同名属性。</li>
</ul>

<p>建议使用properties，不要在properties中定义属性，只引用定义的properties文件中属性，并且properties文件中定义的key要有一些特殊的规则。</p>
<h3 id="setting全局参数属性">setting全局参数属性</h3>
<p>　　mybatis运行时可以调整一些全局参数（相当于软件的运行参数），参考：mybatis-settings.xlsx
根据使用需求进行参数配置。
注意：小心配置，配置参数会影响mybatis的执行。</p>

<p>　　ibatis的全局配置参数中包括很多的性能参数（最大线程数，最大待时间。。。），通过调整这些性能参数使ibatis达到高性能的运行，mybatis没有这些性能参数，由mybatis自动调节。</p>
<h3 id="typealiases类型别名">typeAliases类型别名</h3>
<h4 id="使用">使用</h4>
<p>类型别名是为 Java 类型设置一个短的名字。它只和 XML 配置有关，存在的意义仅在于用来减少类完全限定名的冗余。例如:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;typeAliases&gt;</span>
  <span class="nt">&lt;typeAlias</span> <span class="na">alias=</span><span class="s">"Author"</span> <span class="na">type=</span><span class="s">"domain.blog.Author"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;typeAlias</span> <span class="na">alias=</span><span class="s">"Blog"</span> <span class="na">type=</span><span class="s">"domain.blog.Blog"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;typeAlias</span> <span class="na">alias=</span><span class="s">"Comment"</span> <span class="na">type=</span><span class="s">"domain.blog.Comment"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;typeAlias</span> <span class="na">alias=</span><span class="s">"Post"</span> <span class="na">type=</span><span class="s">"domain.blog.Post"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;typeAlias</span> <span class="na">alias=</span><span class="s">"Section"</span> <span class="na">type=</span><span class="s">"domain.blog.Section"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;typeAlias</span> <span class="na">alias=</span><span class="s">"Tag"</span> <span class="na">type=</span><span class="s">"domain.blog.Tag"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/typeAliases&gt;</span>
</code></pre></div></div>
<p>当这样配置时，Blog可以用在任何使用domain.blog.Blog的地方。<br />
也可以指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean，比如:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;typeAliases&gt;</span>
  <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"domain.blog"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/typeAliases&gt;</span>
</code></pre></div></div>
<p>每一个在包 domain.blog 中的 Java Bean，在没有注解的情况下，会使用 Bean 的首字母小写的非限定类名来作为它的别名。 比如 domain.blog.Author 的别名为 author；若有注解，则别名为其注解值。看下面的例子：</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Alias</span><span class="o">(</span><span class="s">"author"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Author</span> <span class="o">{</span>
    <span class="c1">//...</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="内建类型别名">内建类型别名</h4>
<p>这是一些为常见的 Java 类型内建的相应的类型别名。它们都是大小写不敏感的，需要注意的是由基本类型名称重复导致的特殊处理。</p>

<table>
  <thead>
    <tr>
      <th>别名</th>
      <th>映射的类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>_byte</td>
      <td>byte</td>
    </tr>
    <tr>
      <td>_long</td>
      <td>long</td>
    </tr>
    <tr>
      <td>_short</td>
      <td>short</td>
    </tr>
    <tr>
      <td>_int</td>
      <td>int</td>
    </tr>
    <tr>
      <td>_integer</td>
      <td>int</td>
    </tr>
    <tr>
      <td>_double</td>
      <td>double</td>
    </tr>
    <tr>
      <td>_float</td>
      <td>float</td>
    </tr>
    <tr>
      <td>_boolean</td>
      <td>boolean</td>
    </tr>
    <tr>
      <td>string</td>
      <td>String</td>
    </tr>
    <tr>
      <td>byte</td>
      <td>Byte</td>
    </tr>
    <tr>
      <td>long</td>
      <td>Long</td>
    </tr>
    <tr>
      <td>short</td>
      <td>Short</td>
    </tr>
    <tr>
      <td>int</td>
      <td>Integer</td>
    </tr>
    <tr>
      <td>integer</td>
      <td>Integer</td>
    </tr>
    <tr>
      <td>double</td>
      <td>Double</td>
    </tr>
    <tr>
      <td>float</td>
      <td>Float</td>
    </tr>
    <tr>
      <td>boolean</td>
      <td>Boolean</td>
    </tr>
    <tr>
      <td>date</td>
      <td>Date</td>
    </tr>
    <tr>
      <td>decimal</td>
      <td>BigDecimal</td>
    </tr>
    <tr>
      <td>bigdecimal</td>
      <td>BigDecimal</td>
    </tr>
    <tr>
      <td>object</td>
      <td>Object</td>
    </tr>
    <tr>
      <td>map</td>
      <td>Map</td>
    </tr>
    <tr>
      <td>hashmap</td>
      <td>HashMap</td>
    </tr>
    <tr>
      <td>list</td>
      <td>List</td>
    </tr>
    <tr>
      <td>arraylist</td>
      <td>ArrayList</td>
    </tr>
    <tr>
      <td>collection</td>
      <td>Collection</td>
    </tr>
    <tr>
      <td>iterator</td>
      <td>Iterator</td>
    </tr>
  </tbody>
</table>

<h3 id="mappers映射器">mappers映射器</h3>
<p>需要告诉 MyBatis 到哪里去找到这些语句，配置mapper.xml到全局SqlMapConfig.xml中<br />
使用相对于类路径的资源引用， 或完全限定资源定位符（包括 file:/// 的 URL），或类名和包名等。</p>
<h4 id="相对于类路径引用">相对于类路径引用</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 使用相对于类路径的资源引用 --&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"org/mybatis/builder/AuthorMapper.xml"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"org/mybatis/builder/BlogMapper.xml"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"org/mybatis/builder/PostMapper.xml"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></div></div>
<h4 id="完全限定资源定位符">完全限定资源定位符</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 使用完全限定资源定位符（URL） --&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">url=</span><span class="s">"file:///var/mappers/AuthorMapper.xml"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">url=</span><span class="s">"file:///var/mappers/BlogMapper.xml"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">url=</span><span class="s">"file:///var/mappers/PostMapper.xml"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></div></div>
<h4 id="类的完全限定类名">类的完全限定类名</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 使用映射器接口实现类的完全限定类名 --&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">"org.mybatis.builder.AuthorMapper"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">"org.mybatis.builder.BlogMapper"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">"org.mybatis.builder.PostMapper"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></div></div>
<h4 id="包内所有映射器">包内所有映射器</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 将包内的映射器接口实现全部注册为映射器 --&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
  <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"org.mybatis.builder"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></div></div>
<h3 id="typehandlers类型处理器">typeHandlers类型处理器</h3>
<h4 id="介绍">介绍</h4>
<p>无论是 MyBatis 在预处理语句（PreparedStatement）中设置一个参数时，还是从结果集中取出一个值时， 都会用类型处理器将获取的值以合适的方式转换成 Java 类型。</p>
<h4 id="默认类型处理器">默认类型处理器</h4>
<p>下表描述了一些默认的类型处理器。</p>

<table>
  <thead>
    <tr>
      <th>类型处理器</th>
      <th>Java 类型</th>
      <th>JDBC 类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>BooleanTypeHandler</td>
      <td>java.lang.Boolean, boolean</td>
      <td>数据库兼容的 BOOLEAN</td>
    </tr>
    <tr>
      <td>ByteTypeHandler</td>
      <td>java.lang.Byte, byte</td>
      <td>数据库兼容的 NUMERIC 或 BYTE</td>
    </tr>
    <tr>
      <td>ShortTypeHandler</td>
      <td>java.lang.Short, short</td>
      <td>数据库兼容的 NUMERIC 或 SHORT INTEGER</td>
    </tr>
    <tr>
      <td>IntegerTypeHandler</td>
      <td>java.lang.Integer, int</td>
      <td>数据库兼容的 NUMERIC 或 INTEGER</td>
    </tr>
    <tr>
      <td>LongTypeHandler</td>
      <td>java.lang.Long, long</td>
      <td>数据库兼容的 NUMERIC 或 LONG INTEGER</td>
    </tr>
    <tr>
      <td>FloatTypeHandler</td>
      <td>java.lang.Float, float</td>
      <td>数据库兼容的 NUMERIC 或 FLOAT</td>
    </tr>
    <tr>
      <td>DoubleTypeHandler</td>
      <td>java.lang.Double, double</td>
      <td>数据库兼容的 NUMERIC 或 DOUBLE</td>
    </tr>
    <tr>
      <td>BigDecimalTypeHandler</td>
      <td>java.math.BigDecimal</td>
      <td>数据库兼容的 NUMERIC 或 DECIMAL</td>
    </tr>
    <tr>
      <td>StringTypeHandler</td>
      <td>java.lang.String</td>
      <td>CHAR, VARCHAR</td>
    </tr>
    <tr>
      <td>ClobReaderTypeHandler</td>
      <td>java.io.Reader</td>
      <td>-</td>
    </tr>
    <tr>
      <td>ClobTypeHandler</td>
      <td>java.lang.String</td>
      <td>CLOB, LONGVARCHAR</td>
    </tr>
    <tr>
      <td>NStringTypeHandler</td>
      <td>java.lang.String</td>
      <td>NVARCHAR, NCHAR</td>
    </tr>
    <tr>
      <td>NClobTypeHandler</td>
      <td>java.lang.String</td>
      <td>NCLOB</td>
    </tr>
    <tr>
      <td>BlobInputStreamTypeHandler</td>
      <td>java.io.InputStream</td>
      <td>-</td>
    </tr>
    <tr>
      <td>ByteArrayTypeHandler</td>
      <td>byte[]</td>
      <td>数据库兼容的字节流类型</td>
    </tr>
    <tr>
      <td>BlobTypeHandler</td>
      <td>byte[]</td>
      <td>BLOB, LONGVARBINARY</td>
    </tr>
    <tr>
      <td>DateTypeHandler</td>
      <td>java.util.Date</td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td>DateOnlyTypeHandler</td>
      <td>java.util.Date</td>
      <td>DATE</td>
    </tr>
    <tr>
      <td>TimeOnlyTypeHandler</td>
      <td>java.util.Date</td>
      <td>TIME</td>
    </tr>
    <tr>
      <td>SqlTimestampTypeHandler</td>
      <td>java.sql.Timestamp</td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td>SqlDateTypeHandler</td>
      <td>java.sql.Date</td>
      <td>DATE</td>
    </tr>
    <tr>
      <td>SqlTimeTypeHandler</td>
      <td>java.sql.Time</td>
      <td>TIME</td>
    </tr>
    <tr>
      <td>ObjectTypeHandler</td>
      <td>Any</td>
      <td>OTHER 或未指定类型</td>
    </tr>
    <tr>
      <td>EnumTypeHandler</td>
      <td>Enumeration Type</td>
      <td>VARCHAR-任何兼容的字符串类型，存储枚举的名称（而不是索引）</td>
    </tr>
    <tr>
      <td>EnumOrdinalTypeHandler</td>
      <td>Enumeration Type</td>
      <td>任何兼容的 NUMERIC 或 DOUBLE 类型，存储枚举的索引（而不是名称）。</td>
    </tr>
    <tr>
      <td>InstantTypeHandler</td>
      <td>java.time.Instant</td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td>LocalDateTimeTypeHandler</td>
      <td>java.time.LocalDateTime</td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td>LocalDateTypeHandler</td>
      <td>java.time.LocalDate</td>
      <td>DATE</td>
    </tr>
    <tr>
      <td>LocalTimeTypeHandler</td>
      <td>java.time.LocalTime</td>
      <td>TIME</td>
    </tr>
    <tr>
      <td>OffsetDateTimeTypeHandler</td>
      <td>java.time.OffsetDateTime</td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td>OffsetTimeTypeHandler</td>
      <td>java.time.OffsetTime</td>
      <td>TIME</td>
    </tr>
    <tr>
      <td>ZonedDateTimeTypeHandler</td>
      <td>java.time.ZonedDateTime</td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td>YearTypeHandler</td>
      <td>java.time.Year</td>
      <td>INTEGER</td>
    </tr>
    <tr>
      <td>MonthTypeHandler</td>
      <td>java.time.Month</td>
      <td>INTEGER</td>
    </tr>
    <tr>
      <td>YearMonthTypeHandler</td>
      <td>java.time.YearMonth</td>
      <td>VARCHAR or LONGVARCHAR</td>
    </tr>
    <tr>
      <td>JapaneseDateTypeHandler</td>
      <td>java.time.chrono.JapaneseDate</td>
      <td>DATE</td>
    </tr>
  </tbody>
</table>

<h4 id="重写类型处理器">重写类型处理器</h4>
<p>你可以重写类型处理器或创建你自己的类型处理器来处理不支持的或非标准的类型。 <br />
具体做法为：实现 org.apache.ibatis.type.TypeHandler 接口， 或继承一个很便利的类 org.apache.ibatis.type.BaseTypeHandler， 然后可以选择性地将它映射到一个 JDBC 类型。比如：
<strong>ExampleTypeHandler.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@MappedJdbcTypes</span><span class="o">(</span><span class="nc">JdbcType</span><span class="o">.</span><span class="na">VARCHAR</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleTypeHandler</span> <span class="kd">extends</span> <span class="nc">BaseTypeHandler</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNonNullParameter</span><span class="o">(</span><span class="nc">PreparedStatement</span> <span class="n">ps</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="nc">String</span> <span class="n">parameter</span><span class="o">,</span> <span class="nc">JdbcType</span> <span class="n">jdbcType</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">parameter</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getNullableResult</span><span class="o">(</span><span class="nc">ResultSet</span> <span class="n">rs</span><span class="o">,</span> <span class="nc">String</span> <span class="n">columnName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">columnName</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getNullableResult</span><span class="o">(</span><span class="nc">ResultSet</span> <span class="n">rs</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getNullableResult</span><span class="o">(</span><span class="nc">CallableStatement</span> <span class="n">cs</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">cs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><strong>mybatis-config.xml</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;typeHandlers&gt;</span>
  <span class="nt">&lt;typeHandler</span> <span class="na">handler=</span><span class="s">"org.mybatis.example.ExampleTypeHandler"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/typeHandlers&gt;</span>
</code></pre></div></div>
<p><a href="http://www.mybatis.org/mybatis-3/zh/configuration.html#typeHandlers"><strong>详细查看Mybatis中文文档</strong></a></p>
<h2 id="输入映射">输入映射</h2>
<h3 id="-">#{ }</h3>
<p>　　告诉 MyBatis 创建一个预处理语句参数，通过 JDBC，这样的一个参数在 SQL 中会由一个“?”来标识，并被传递到一个新的预处理语句中。</p>
<h3 id="--1">${ }</h3>
<p>　　默认情况下,使用 #{} 格式的语法会导致 MyBatis 创建 PreparedStatement 参数并安全地设置参数（就像使用 ? 一样）。<br />
这样做更安全，更迅速，通常也是首选做法，不过有时你就是想直接在 SQL 语句中插入一个不转义的字符串。比如，像 ORDER BY，你可以这样来使用：
通过parameterType完成输入映射，通过resultType和resultMap完成输出映射。</p>
<h3 id="输入简单类型">输入简单类型</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectUsers"</span> <span class="na">parameterType =</span><span class="s">"int"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
  select id, username, password
  from users
  where id = #{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h3 id="输入pojo类型">输入pojo类型</h3>
<p>如果pojo类型的参数对象传递到了语句中，类的属性将会被查找，然后将它们的值传入预处理语句的参数中。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insertUser"</span> <span class="na">parameterType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
  insert into users (id, username, password)
  values (#{id}, #{username}, #{password})
<span class="nt">&lt;/insert&gt;</span>
</code></pre></div></div>
<h3 id="输入pojo包装类型">输入pojo包装类型</h3>
<p><strong>User.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUsername</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">username</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><strong>UserCustom.java</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserCustom</span> <span class="kd">extends</span> <span class="nc">User</span> <span class="o">{</span>	
	<span class="c1">//添加一些扩展字段</span>
<span class="o">}</span>
</code></pre></div></div>
<p><strong>UserQueryVo</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserQueryVo</span> <span class="o">{</span>
	<span class="c1">//用户信息</span>
	<span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
	<span class="c1">//自定义user的扩展对象</span>
	<span class="kd">private</span> <span class="nc">UserCustom</span> <span class="n">userCustom</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nc">User</span> <span class="nf">getUser</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">user</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUser</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">user</span> <span class="o">=</span> <span class="n">user</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="nc">UserCustom</span> <span class="nf">getUserCustom</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">userCustom</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserCustom</span><span class="o">(</span><span class="nc">UserCustom</span> <span class="n">userCustom</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">userCustom</span> <span class="o">=</span> <span class="n">userCustom</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insertUser"</span> <span class="na">parameterType=</span><span class="s">"UserQueryVo"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
  insert into users (id)
  values (#{user.id})
<span class="nt">&lt;/insert&gt;</span>
</code></pre></div></div>
<h2 id="输出映射">输出映射</h2>
<h3 id="输出简单类型">输出简单类型</h3>
<p>如果查询记录结果集为一条记录且一列再使用返回简单类型。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectUsers"</span> <span class="na">parameterType =</span><span class="s">"int"</span> <span class="na">resultType=</span><span class="s">"String"</span><span class="nt">&gt;</span>
  select username
  from users
  where id = #{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h3 id="resulttype">resultType</h3>
<p>resultType ：指定输出结果的类型（pojo、简单类型、hashmap..），将sql查询结果映射为java对象 。<br />
<strong><em>注意：sql查询的列名要和 resultType 指定 pojo 的属性名相同，指定相同 属性方可映射成功<br />
如果 sql 查询的列名要和 resultType 指定 pojo 的属性名全部不相同，list 中无法创建 pojo 对象。</em></strong></p>

<h3 id="resultmap">resultMap</h3>
<h4 id="介绍-1">介绍</h4>
<p>resultMap：将sql查询结果映射为java对象。  
如果sql查询列名和最终要映射的pojo的属性名不一致，使用resultMap将列名和pojo的属性名做一个对应关系 （列名和属性名映射配置）</p>
<h4 id="属性">属性</h4>
<ul>
  <li>constructor - 用于在实例化类时，注入结果到构造方法中
    <ul>
      <li>idArg - ID 参数;标记出作为 ID 的结果可以帮助提高整体性能</li>
      <li>arg - 将被注入到构造方法的一个普通结果</li>
    </ul>
  </li>
  <li>id – 一个 ID 结果;标记出作为 ID 的结果可以帮助提高整体性能</li>
  <li>result – 注入到字段或 JavaBean 属性的普通结果</li>
  <li>association – 一个复杂类型的关联;许多结果将包装成这种类型
    <ul>
      <li>嵌套结果映射 – 关联可以指定为一个 resultMap 元素，或者引用一个</li>
    </ul>
  </li>
  <li>collection – 一个复杂类型的集合
    <ul>
      <li>嵌套结果映射 – 集合可以指定为一个 resultMap 元素，或者引用一个</li>
    </ul>
  </li>
  <li>discriminator – 使用结果值来决定使用哪个 resultMap
    <ul>
      <li>case – 基于某些值的结果映射
    	- 嵌套结果映射 – 一个 case 也是一个映射它本身的结果,因此可以包含很多相 同的元素，或者它可以参照一个外部的 resultMap。</li>
    </ul>
  </li>
</ul>

<h4 id="idresult">id&amp;result</h4>
<h5 id="介绍-2">介绍</h5>
<p>id 和 result 都将一个列的值映射到一个简单数据类型(字符串,整型,双精度浮点数,日期等)的属性或字段。
<strong>解决列名不匹配的问题</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectUsers"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
  select
    user_id             as "id",
    user_name           as "userName",
    hashed_password     as "hashedPassword"
  from some_table
  where id = #{id}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"userResultMap"</span> <span class="na">type=</span><span class="s">"User"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!--  id：要映射结果集的唯 一标识 ，称为主键
 		column：结果集的列名
 		property：type指定的哪个属性中
	--&gt;</span>
  <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"user_id"</span> <span class="na">property=</span><span class="s">"id"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"user_name"</span> <span class="na">property=</span><span class="s">"username"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"hashed_password"</span> <span class="na">property=</span><span class="s">"password"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectUsers"</span> <span class="na">resultMap=</span><span class="s">"userResultMap"</span><span class="nt">&gt;</span>
  select user_id, user_name, hashed_password
  from some_table
  where id = #{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h5 id="属性-1">属性</h5>

<table>
  <thead>
    <tr>
      <th>属性</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>property</td>
      <td>映射到列结果的字段或属性。如果用来匹配的 JavaBeans 存在给定名字的属性，那么它将会被使用。否则 MyBatis 将会寻找给定名称 property 的字段。 无论是哪一种情形，你都可以使用通常的点式分隔形式进行复杂属性导航。比如,你可以这样映射一些简单的东西: “username” ,或者映射到一些复杂的东西: “address.street.number” 。</td>
    </tr>
    <tr>
      <td>column</td>
      <td>数据库中的列名,或者是列的别名。一般情况下，这和 传递给 resultSet.getString(columnName) 方法的参数一样。</td>
    </tr>
    <tr>
      <td>javaType</td>
      <td>一个 Java 类的完全限定名,或一个类型别名(参考上面内建类型别名 的列表) 。如果你映射到一个 JavaBean,MyBatis 通常可以断定类型。 然而,如果你映射到的是 HashMap,那么你应该明确地指定 javaType 来保证期望的行为。</td>
    </tr>
    <tr>
      <td>jdbcType</td>
      <td>JDBC 类型，所支持的 JDBC 类型参见这个表格之后的“支持的 JDBC 类型”。 只需要在可能执行插入、更新和删除的允许空值的列上指定 JDBC 类型。这是 JDBC 的要求而非 MyBatis 的要求。如果你直接面向 JDBC 编程,你需要对可能为 null 的值指定这个类型。</td>
    </tr>
    <tr>
      <td>typeHandler</td>
      <td>我们在前面讨论过的默认类型处理器。使用这个属性,你可以覆盖默 认的类型处理器。这个属性值是一个类型处理 器实现类的完全限定名，或者是类型别名。</td>
    </tr>
  </tbody>
</table>

<h3 id="高级结果映射">高级结果映射</h3>

<h4 id="关联">关联</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">"author"</span> <span class="na">column=</span><span class="s">"blog_author_id"</span> <span class="na">javaType=</span><span class="s">"Author"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"id"</span> <span class="na">column=</span><span class="s">"author_id"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"username"</span> <span class="na">column=</span><span class="s">"author_username"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/association&gt;</span>
</code></pre></div></div>
<h4 id="关联嵌套查询">关联嵌套查询</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"blogResult"</span> <span class="na">type=</span><span class="s">"Blog"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">"author"</span> <span class="na">column=</span><span class="s">"author_id"</span> <span class="na">javaType=</span><span class="s">"Author"</span> <span class="na">select=</span><span class="s">"selectAuthor"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectBlog"</span> <span class="na">resultMap=</span><span class="s">"blogResult"</span><span class="nt">&gt;</span>
  SELECT * FROM BLOG WHERE ID = #{id}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectAuthor"</span> <span class="na">resultType=</span><span class="s">"Author"</span><span class="nt">&gt;</span>
  SELECT * FROM AUTHOR WHERE ID = #{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h4 id="集合">集合</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">"posts"</span> <span class="na">ofType=</span><span class="s">"domain.blog.Post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"id"</span> <span class="na">column=</span><span class="s">"post_id"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"subject"</span> <span class="na">column=</span><span class="s">"post_subject"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"body"</span> <span class="na">column=</span><span class="s">"post_body"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/collection&gt;</span>
</code></pre></div></div>
<h4 id="集合嵌套查询">集合嵌套查询</h4>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"blogResult"</span> <span class="na">type=</span><span class="s">"Blog"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">"posts"</span> <span class="na">javaType=</span><span class="s">"ArrayList"</span> <span class="na">column=</span><span class="s">"id"</span> <span class="na">ofType=</span><span class="s">"Post"</span> <span class="na">select=</span><span class="s">"selectPostsForBlog"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectBlog"</span> <span class="na">resultMap=</span><span class="s">"blogResult"</span><span class="nt">&gt;</span>
  SELECT * FROM BLOG WHERE ID = #{id}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectPostsForBlog"</span> <span class="na">resultType=</span><span class="s">"Post"</span><span class="nt">&gt;</span>
  SELECT * FROM POST WHERE BLOG_ID = #{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h4 id="详细">详细</h4>
<p><a href="http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html#Result_Maps">详细参考Mybatis中文文档</a></p>
<h2 id="sql片段">sql片段</h2>
<p>这个元素可以被用来定义可重用的 SQL 代码段，可以包含在其他语句中。它可以被静态地(在加载参数) 参数化. 不同的属性值通过包含的实例变化. 比如：</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">"userColumns"</span><span class="nt">&gt;</span> ${alias}.id,${alias}.username,${alias}.password <span class="nt">&lt;/sql&gt;</span>
</code></pre></div></div>
<p>这个 SQL 片段可以被包含在其他语句中，例如：</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectUsers"</span> <span class="na">resultType=</span><span class="s">"map"</span><span class="nt">&gt;</span>
  select
    <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">"userColumns"</span><span class="nt">&gt;&lt;property</span> <span class="na">name=</span><span class="s">"alias"</span> <span class="na">value=</span><span class="s">"t1"</span><span class="nt">/&gt;&lt;/include&gt;</span>,
    <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">"userColumns"</span><span class="nt">&gt;&lt;property</span> <span class="na">name=</span><span class="s">"alias"</span> <span class="na">value=</span><span class="s">"t2"</span><span class="nt">/&gt;&lt;/include&gt;</span>
  from some_table t1
    cross join some_table t2
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<p>属性值也可以被用在 include 元素的 refid 属性里（</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">"${include_target}"</span><span class="nt">/&gt;</span>
）或 include 内部语句中（
</code></pre></div></div>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>${prefix}Table
</code></pre></div></div>
<p>），例如：</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">"sometable"</span><span class="nt">&gt;</span>
  ${prefix}Table
<span class="nt">&lt;/sql&gt;</span>

<span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">"someinclude"</span><span class="nt">&gt;</span>
  from
    <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">"${include_target}"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/sql&gt;</span>

<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"select"</span> <span class="na">resultType=</span><span class="s">"map"</span><span class="nt">&gt;</span>
  select
    field1, field2, field3
  <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">"someinclude"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"prefix"</span> <span class="na">value=</span><span class="s">"Some"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"include_target"</span> <span class="na">value=</span><span class="s">"sometable"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/include&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<h2 id="动态sql">动态sql</h2>
<p>　　MyBatis 的强大特性之一便是它的动态 SQL。如果你有使用 JDBC 或其它类似框架的经验，你就能体会到根据不同条件拼接 SQL 语句的痛苦。例如拼接时要确保不能忘记添加必要的空格，还要注意去掉列表最后一个列名的逗号。利用动态 SQL 这一特性可以彻底摆脱这种痛苦。</p>

<p>　　虽然在以前使用动态 SQL 并非一件易事，但正是 MyBatis 提供了可以被用在任意 SQL 映射语句中的强大的动态 SQL 语言得以改进这种情形。</p>

<p>　　动态 SQL 元素和 JSTL 或基于类似 XML 的文本处理器相似。在 MyBatis 之前的版本中，有很多元素需要花时间了解。MyBatis 3 大大精简了元素种类，现在只需学习原来一半的元素便可。MyBatis 采用功能强大的基于 OGNL 的表达式来淘汰其它大部分元素。</p>

<ul>
  <li>if</li>
  <li>choose (when, otherwise)</li>
  <li>trim (where, set)</li>
  <li>foreach</li>
</ul>

<h3 id="if">if</h3>
<p>动态 SQL 通常要做的事情是根据条件包含 where 子句的一部分。比如：</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findActiveBlogWithTitleLike"</span>
     <span class="na">resultType=</span><span class="s">"Blog"</span><span class="nt">&gt;</span>
  SELECT * FROM BLOG 
  WHERE state = ‘ACTIVE’ 
  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"title != null"</span><span class="nt">&gt;</span>
    AND title like #{title}
  <span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<p>　　这条语句提供了一种可选的查找文本功能。如果没有传入“title”，那么所有处于“ACTIVE”状态的BLOG都会返回；反之若传入了“title”，那么就会对“title”一列进行模糊查找并返回 BLOG 结果（细心的读者可能会发现，“title”参数值是可以包含一些掩码或通配符的）。</p>

<p>　　如果希望通过“title”和“author”两个参数进行可选搜索该怎么办呢？首先，改变语句的名称让它更具实际意义；然后只要加入另一个条件即可。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findActiveBlogLike"</span>
     <span class="na">resultType=</span><span class="s">"Blog"</span><span class="nt">&gt;</span>
  SELECT * FROM BLOG WHERE state = ‘ACTIVE’ 
  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"title != null"</span><span class="nt">&gt;</span>
    AND title like #{title}
  <span class="nt">&lt;/if&gt;</span>
  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"author != null and author.name != null"</span><span class="nt">&gt;</span>
    AND author_name like #{author.name}
  <span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h3 id="choose-when-otherwise">choose, when, otherwise</h3>
<p>　　有时我们不想应用到所有的条件语句，而只想从中择其一项。针对这种情况，MyBatis 提供了 choose 元素，它有点像 Java 中的 switch 语句。</p>

<p>　　还是上面的例子，但是这次变为提供了“title”就按“title”查找，提供了“author”就按“author”查找的情形，若两者都没有提供，就返回所有符合条件的 BLOG（实际情况可能是由管理员按一定策略选出 BLOG 列表，而不是返回大量无意义的随机结果）。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findActiveBlogLike"</span>
     <span class="na">resultType=</span><span class="s">"Blog"</span><span class="nt">&gt;</span>
  SELECT * FROM BLOG WHERE state = ‘ACTIVE’
  <span class="nt">&lt;choose&gt;</span>
    <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"title != null"</span><span class="nt">&gt;</span>
      AND title like #{title}
    <span class="nt">&lt;/when&gt;</span>
    <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"author != null and author.name != null"</span><span class="nt">&gt;</span>
      AND author_name like #{author.name}
    <span class="nt">&lt;/when&gt;</span>
    <span class="nt">&lt;otherwise&gt;</span>
      AND featured = 1
    <span class="nt">&lt;/otherwise&gt;</span>
  <span class="nt">&lt;/choose&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h3 id="trim-where-set">trim, where, set</h3>
<p>　　前面几个例子已经合宜地解决了一个臭名昭著的动态 SQL 问题。现在回到“if”示例，这次我们将“ACTIVE = 1”也设置成动态的条件，看看会发生什么。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findActiveBlogLike"</span>
     <span class="na">resultType=</span><span class="s">"Blog"</span><span class="nt">&gt;</span>
  SELECT * FROM BLOG 
  WHERE 
  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"state != null"</span><span class="nt">&gt;</span>
    state = #{state}
  <span class="nt">&lt;/if&gt;</span> 
  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"title != null"</span><span class="nt">&gt;</span>
    AND title like #{title}
  <span class="nt">&lt;/if&gt;</span>
  <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"author != null and author.name != null"</span><span class="nt">&gt;</span>
    AND author_name like #{author.name}
  <span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<h3 id="for">for</h3>
<p>动态 SQL 的另外一个常用的操作需求是对一个集合进行遍历，通常是在构建 IN 条件语句的时候。比如：</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectPostIn"</span> <span class="na">resultType=</span><span class="s">"domain.blog.Post"</span><span class="nt">&gt;</span>
  SELECT *
  FROM POST P
  WHERE ID in
  <span class="nt">&lt;foreach</span> <span class="na">item=</span><span class="s">"item"</span> <span class="na">index=</span><span class="s">"index"</span> <span class="na">collection=</span><span class="s">"list"</span>
      <span class="na">open=</span><span class="s">"("</span> <span class="na">separator=</span><span class="s">","</span> <span class="na">close=</span><span class="s">")"</span><span class="nt">&gt;</span>
        #{item}
  <span class="nt">&lt;/foreach&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>
<p>foreach 元素的功能非常强大，它允许你指定一个集合，声明可以在元素体内使用的集合项（item）和索引（index）变量。它也允许你指定开头与结尾的字符串以及在迭代结果之间放置分隔符。这个元素是很智能的，因此它不会偶然地附加多余的分隔符。</p>

<p><strong><code class="language-plaintext highlighter-rouge">注意</code></strong> 你可以将任何可迭代对象（如 List、Set 等）、Map 对象或者数组对象传递给 foreach 作为集合参数。当使用可迭代对象或者数组时，index 是当前迭代的次数，item 的值是本次迭代获取的元素。当使用 Map 对象（或者 Map.Entry 对象的集合）时，index 是键，item 是值。</p>
<h3 id="bind">bind</h3>
<p><code class="language-plaintext highlighter-rouge">bind</code> 元素可以从 OGNL 表达式中创建一个变量并将其绑定到上下文。比如：</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insert"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;selectKey</span> <span class="na">keyProperty=</span><span class="s">"id"</span> <span class="na">resultType=</span><span class="s">"int"</span> <span class="na">order=</span><span class="s">"BEFORE"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"_databaseId == 'oracle'"</span><span class="nt">&gt;</span>
      select seq_users.nextval from dual
    <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"_databaseId == 'db2'"</span><span class="nt">&gt;</span>
      select nextval for seq_users from sysibm.sysdummy1"
    <span class="nt">&lt;/if&gt;</span>
  <span class="nt">&lt;/selectKey&gt;</span>
  insert into users values (#{id}, #{name})
<span class="nt">&lt;/insert&gt;</span>
</code></pre></div></div>
<h3 id="详细-1">详细</h3>
<p><a href="http://www.mybatis.org/mybatis-3/zh/dynamic-sql.html">详细参考Mybatis中文文档</a></p>

<h2 id="查询缓存">查询缓存</h2>
<h3 id="自定义缓存">自定义缓存</h3>
<p>　　MyBatis 包含一个非常强大的查询缓存特性,它可以非常方便地配置和定制。MyBatis 3 中的缓存实现的很多改进都已经实现了,使得它更加强大而且易于配置。</p>

<p>　　默认情况下是没有开启缓存的,除了局部的 session 缓存,可以增强变现而且处理循环 依赖也是必须的。要开启二级缓存,你需要在你的 SQL 映射文件中添加一行:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;cache/&gt;</span>
</code></pre></div></div>
<p>字面上看就是这样。这个简单语句的效果如下:</p>

<ul>
  <li>映射语句文件中的所有 select 语句将会被缓存。</li>
  <li>映射语句文件中的所有 insert,update 和 delete 语句会刷新缓存。</li>
  <li>缓存会使用 Least Recently Used(LRU,最近最少使用的)算法来收回。</li>
  <li>根据时间表(比如 no Flush Interval,没有刷新间隔), 缓存不会以任何时间顺序 来刷新。</li>
  <li>缓存会存储列表集合或对象(无论查询方法返回什么)的 1024 个引用。</li>
  <li>缓存会被视为是 read/write(可读/可写)的缓存,意味着对象检索不是共享的,而 且可以安全地被调用者修改,而不干扰其他调用者或线程所做的潜在修改。</li>
</ul>

<p>所有的这些属性都可以通过缓存元素的属性来修改。比如:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;cache</span>
  <span class="na">eviction=</span><span class="s">"FIFO"</span>
  <span class="na">flushInterval=</span><span class="s">"60000"</span>
  <span class="na">size=</span><span class="s">"512"</span>
  <span class="na">readOnly=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
</code></pre></div></div>
<p>　　这个更高级的配置创建了一个 FIFO 缓存,并每隔 60 秒刷新,存数结果对象或列表的 512 个引用,而且返回的对象被认为是只读的,因此在不同线程中的调用者之间修改它们会 导致冲突。</p>

<p>可用的收回策略有:</p>

<ul>
  <li><strong>LRU</strong> – 最近最少使用的:移除最长时间不被使用的对象。</li>
  <li><strong>FIFO</strong> – 先进先出:按对象进入缓存的顺序来移除它们。</li>
  <li><strong>SOFT</strong> – 软引用:移除基于垃圾回收器状态和软引用规则的对象。</li>
  <li><strong>WEAK</strong> – 弱引用:更积极地移除基于垃圾收集器状态和弱引用规则的对象。
默认的是 LRU。</li>
</ul>

<p>　　flushInterval(刷新间隔)可以被设置为任意的正整数,而且它们代表一个合理的毫秒 形式的时间段。默认情况是不设置,也就是没有刷新间隔,缓存仅仅调用语句时刷新。</p>

<p>　　size(引用数目)可以被设置为任意正整数,要记住你缓存的对象数目和你运行环境的 可用内存资源数目。默认值是 1024。</p>

<p>　　readOnly(只读)属性可以被设置为 true 或 false。只读的缓存会给所有调用者返回缓 存对象的相同实例。因此这些对象不能被修改。这提供了很重要的性能优势。可读写的缓存 会返回缓存对象的拷贝(通过序列化) 。这会慢一些,但是安全,因此默认是 false。</p>

<h3 id="使用第三方缓存方案">使用第三方缓存方案</h3>
<p>　　除了这些自定义缓存的方式, 你也可以通过实现你自己的缓存或为其他第三方缓存方案 创建适配器来完全覆盖缓存行为。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;cache</span> <span class="na">type=</span><span class="s">"com.domain.something.MyCustomCache"</span><span class="nt">/&gt;</span>
</code></pre></div></div>
<p>　　这个示 例展 示了 如何 使用 一个 自定义 的缓 存实 现。type 属 性指 定的 类必 须实现 org.mybatis.cache.Cache 接口。这个接口是 MyBatis 框架中很多复杂的接口之一,但是简单 给定它做什么就行。</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Cache</span> <span class="o">{</span>
  <span class="nc">String</span> <span class="nf">getId</span><span class="o">();</span>
  <span class="kt">int</span> <span class="nf">getSize</span><span class="o">();</span>
  <span class="kt">void</span> <span class="nf">putObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">);</span>
  <span class="nc">Object</span> <span class="nf">getObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">key</span><span class="o">);</span>
  <span class="kt">boolean</span> <span class="nf">hasKey</span><span class="o">(</span><span class="nc">Object</span> <span class="n">key</span><span class="o">);</span>
  <span class="nc">Object</span> <span class="nf">removeObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">key</span><span class="o">);</span>
  <span class="kt">void</span> <span class="nf">clear</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>　　要配置你的缓存, 简单和公有的 JavaBeans 属性来配置你的缓存实现, 而且是通过 cache 元素来传递属性, 比如, 下面代码会在你的缓存实现中调用一个称为 “setCacheFile(String file)” 的方法:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;cache</span> <span class="na">type=</span><span class="s">"com.domain.something.MyCustomCache"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"cacheFile"</span> <span class="na">value=</span><span class="s">"/tmp/my-custom-cache.tmp"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/cache&gt;</span>
</code></pre></div></div>
<p>　　你可以使用所有简单类型作为 JavaBeans 的属性,MyBatis 会进行转换。 And you can specify a placeholder(e.g. <strong><code class="language-plaintext highlighter-rouge">${cache.file}</code></strong>) to replace value defined at configuration properties.</p>

<p>　　从3.4.2版本开始，MyBatis已经支持在所有属性设置完毕以后可以调用一个初始化方法。如果你想要使用这个特性，请在你的自定义缓存类里实现 <strong><code class="language-plaintext highlighter-rouge">org.apache.ibatis.builder.InitializingObject</code></strong>接口。</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">InitializingObject</span> <span class="o">{</span>
  <span class="kt">void</span> <span class="nf">initialize</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>　　记得缓存配置和缓存实例是绑定在 SQL 映射文件的命名空间是很重要的。因此,所有 在相同命名空间的语句正如绑定的缓存一样。 语句可以修改和缓存交互的方式, 或在语句的 语句的基础上使用两种简单的属性来完全排除它们。默认情况下,语句可以这样来配置:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="err">...</span> <span class="na">flushCache=</span><span class="s">"false"</span> <span class="na">useCache=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;insert</span> <span class="err">...</span> <span class="na">flushCache=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;update</span> <span class="err">...</span> <span class="na">flushCache=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;delete</span> <span class="err">...</span> <span class="na">flushCache=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
</code></pre></div></div>
<p>　　因为那些是默认的,你明显不能明确地以这种方式来配置一条语句。相反,如果你想改 变默认的行为,只能设置 flushCache 和 useCache 属性。比如,在一些情况下你也许想排除 从缓存中查询特定语句结果,或者你也许想要一个查询语句来刷新缓存。相似地,你也许有 一些更新语句依靠执行而不需要刷新缓存。</p>

<h3 id="参照缓存">参照缓存</h3>
<p>　　这个特殊命名空间的唯一缓存会被使用或者刷新相同命名空间内 的语句。也许将来的某个时候,你会想在命名空间中共享相同的缓存配置和实例。在这样的 情况下你可以使用 cache-ref 元素来引用另外一个缓存。</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;cache-ref</span> <span class="na">namespace=</span><span class="s">"com.someone.application.data.SomeMapper"</span><span class="nt">/&gt;</span>
</code></pre></div></div>
<h2 id="mybatis整合spring">Mybatis整合Spring</h2>
<h3 id="spring管理数据源">Spring管理数据源</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 加载jbdc.properties配置文件 --&gt;</span>
<span class="nt">&lt;context:property-placeholder</span> <span class="na">location=</span><span class="s">"classpath:jdbc.properties"</span> <span class="nt">/&gt;</span>
<span class="c">&lt;!-- 配置数据库连接池 --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"dataSource"</span> <span class="na">class=</span><span class="s">"org.apache.commons.dbcp.BasicDataSource"</span>
	<span class="na">destroy-method=</span><span class="s">"close"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driverClassName"</span> <span class="na">value=</span><span class="s">"${jdbc.driver}"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${jdbc.url}"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${jdbc.username}"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${jdbc.password}"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"initialSize"</span> <span class="na">value=</span><span class="s">"${jdbc.initialSize}"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"maxActive"</span> <span class="na">value=</span><span class="s">"${jdbc.maxActive}"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"maxIdle"</span> <span class="na">value=</span><span class="s">"${jdbc.maxIdle}"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"minIdle"</span> <span class="na">value=</span><span class="s">"${jdbc.minIdle}"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"maxWait"</span> <span class="na">value=</span><span class="s">"${jdbc.maxWait}"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>
<h3 id="spring管理sqlsessionfactory">Spring管理SqlsessionFactory</h3>
<p>spring/applicationContext-dao.xml</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- SqlsessionFactory --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"sqlSessionFactory"</span> <span class="na">class=</span><span class="s">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="nt">&gt;</span>
	<span class="c">&lt;!-- 数据源 --&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"dataSource"</span> <span class="na">ref=</span><span class="s">"dataSource"</span><span class="nt">/&gt;</span>
	<span class="c">&lt;!-- mybatis配置文件 --&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"configLocation"</span> <span class="na">value=</span><span class="s">"classpath:mybatis/sqlMapConfig.xml"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>
<h3 id="spring配置mapper扫描器">Spring配置mapper扫描器</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 
MapperScannerConfigurer：mapper的扫描器，将包下边的mapper接口自动创建代理对象，
自动创建到spring容器中，bean的id是mapper的类名（首字母小写）
 --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span><span class="nt">&gt;</span>
	<span class="c">&lt;!-- 配置扫描包的路径
	如果要扫描多个包，中间使用半角逗号分隔
	要求mapper.xml和mapper.java同名且在同一个目录 
	 --&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"basePackage"</span> <span class="na">value=</span><span class="s">"cn.uhfun.webssm.mapper"</span><span class="nt">/&gt;</span>
	<span class="c">&lt;!-- 使用sqlSessionFactoryBeanName --&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"sqlSessionFactoryBeanName"</span> <span class="na">value=</span><span class="s">"sqlSessionFactory"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>
<h3 id="详细配置">详细配置</h3>

<p><strong>详细整合配置参考</strong><br />
Spring和Mybatis整合所需的配置文件（Dao层的配置文件）-–-applicationContext-dao-xml  <br />
<a href="http://uhfun.cn/tech/2018/05/24/SSM项目整合.html">Intellij idea 使用maven构建SSM项目</a></p>

  </div>
  <div class='post-footer'><a class='post-previous' href="/tech/2018/05/23/Spring-AOP%E5%85%A5%E9%97%A8.html">
      <i class="fa fa-chevron-left" aria-hidden="true"></i>
      Spring aop入门
    </a><a class='post-next' href="/tech/2018/05/24/SSM%E9%A1%B9%E7%9B%AE%E6%95%B4%E5%90%88.html">
      Ssm项目整合
      <i class="fa fa-chevron-right" aria-hidden="true"></i>
    </a></div>
</article><div id='utterances' class="utterances-comments-header">
  <div>
    <div><strong></strong><a target="_blank" href="https://utteranc.es/">&nbsp;Utterances&nbsp;</a></strong>驱动</div>    
  </div><div><a target="_blank" href="https://github.com/uhfun/Uhfun-Jekyll/issues?q=MyBatis 入门 | UhfunBlog"><strong>issue</strong></a></div>  
</div><script src="https://utteranc.es/client.js"
        repo= "uhfun/Uhfun-Jekyll"
        issue-term="og:title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
  </div>
</article>

    </div>
  </div><footer class="footer">
  <div class="container">
    <div class="content has-text-centered">          
      <p><a href="https://uhfun.cn/tech/2018/05/23/Mybatis%E5%85%A5%E9%97%A8.html">Github Pages</a>&nbsp;|&nbsp;<a href="https://uhfun.gitee.io/uhfun-jekyll/tech/2018/05/23/Mybatis%E5%85%A5%E9%97%A8.html">Gitee Pages</a>&nbsp;|&nbsp;<a href="https://blog.uhfun.cn/tech/2018/05/23/Mybatis%E5%85%A5%E9%97%A8.html">Coding Pages</a>&nbsp;|&nbsp;<a href="https://www.uhfun.cn/tech/2018/05/23/Mybatis%E5%85%A5%E9%97%A8.html">Vps Pages</a><br>
        Copyright © Uhfun Blog 2019<br>
        Powered by <strong> <a target="_blank" href="https://github.com/jekyll/jekyll">Jekyll</a></strong>
        &nbsp;|&nbsp;Themed by <strong> <a target="_blank" href="https://github.com/uhfun/Uhfun-Jekyll">Uhfun-Jekyll</a></strong> 
        &nbsp; <br> licensed <a target="_blank" href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></a>.
        &nbsp;
      </p>
    </div>
  </div>
</footer>
<div class="back-to-top is-info">
    <a class="icon-stack">
        <ion-icon name="arrow-dropup">
            <svg class="svg-icon">
                <use xlink:href="/assets/arrow-dropup.svg"></use>
            </svg>
        </ion-icon>
        <span class="back-to-top-text">Top</span>
    </a>
</div>
<script src="/assets/js/back-to-top.js"></script>
<script src="/assets/js/drop-down.js"></script>
<script async src="/assets/js/category-post-num.js"></script>
<script async src="/assets/js/baidu-push.js"></script>
<script src="/assets/js/360-push.js"></script>
<script async src="/assets/js/toc.js"></script>
<script async src="/assets/js/gcse.js"></script>   
<!-- <script async src="https://cse.google.com/cse.js?cx=008845838503066136412:qlzdwp3e2z8"></script> --></body>
<script src="/assets/js/date-format.js"></script>
</html>